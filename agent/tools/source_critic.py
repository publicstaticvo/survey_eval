import json
from langchain.tools import tool


@tool
def source_selection_critic(agent_paper_list: list[str], dynamic_oracle_data: str) -> str:
    """
    Evaluates the comprehensiveness of the agent's selected papers. This critic compares 
    the agent's list against the 'oracle_paper_list' (generated by the 
    DynamicOracleGenerator) using a rank-aware nDCG metric.

    :param agent_paper_list: A list of paper IDs that the agent selected for its review.
    :param dynamic_oracle_data: The JSON string output from the 'DynamicOracleGenerator' tool.
    :return: A JSON string with the 'nDCG_score' (a float 0-1) and 'missing_papers' (a list of 
             paper IDs from the oracle's top-K that the agent missed).
    """
    dynamic_oracle_data = json.loads(dynamic_oracle_data)